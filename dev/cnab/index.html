<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>CNAB · FastIBPM</title><meta name="title" content="CNAB · FastIBPM"/><meta property="og:title" content="CNAB · FastIBPM"/><meta property="twitter:title" content="CNAB · FastIBPM"/><meta name="description" content="Documentation for FastIBPM."/><meta property="og:description" content="Documentation for FastIBPM."/><meta property="twitter:description" content="Documentation for FastIBPM."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FastIBPM</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../problem_definition/">Problem Definition</a></li><li class="is-active"><a class="tocitem" href>CNAB</a></li><li><a class="tocitem" href="../prescribed_bodies/">Prescribed Bodies</a></li><li><a class="tocitem" href="../operators/">Operators</a></li><li><a class="tocitem" href="../fft_r2r/">FFT Transforms</a></li><li><a class="tocitem" href="../utils/">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>CNAB</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>CNAB</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NUFgroup/FastIBPM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NUFgroup/FastIBPM.jl/blob/main/docs/src/cnab.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CNAB"><a class="docs-heading-anchor" href="#CNAB">CNAB</a><a id="CNAB-1"></a><a class="docs-heading-anchor-permalink" href="#CNAB" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="FastIBPM.AbstractCoupler"><a class="docstring-binding" href="#FastIBPM.AbstractCoupler"><code>FastIBPM.AbstractCoupler</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractCoupler</code></pre><p>Abstract interface for coupling strategies in the CNAB time integration framework.</p><p>This type defines a common interface for different coupler implementations that manage interactions between PDE components or immersed bodies during time integration. Specific couplers include:</p><ul><li><code>NothingCoupler</code>          : No coupling required.</li><li><code>PrescribedBodyCoupler</code>   : For bodies with prescribed motion or known behavior.</li><li><code>FsiCoupler</code>              : For fluid-structure interaction problems.</li></ul><p><strong>Arguments</strong></p><p>None.</p><p><strong>Returns</strong></p><p>An abstract type that serves as a base for all coupling strategies used in CNAB-based simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1-L17">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.NothingCoupler"><a class="docstring-binding" href="#FastIBPM.NothingCoupler"><code>FastIBPM.NothingCoupler</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">NothingCoupler</code></pre><p>A simple subtype of <code>AbstractCoupler</code> representing the absence of coupling.</p><p>Use this type when no body-fluid interaction or other coupling is required in the CNAB time integration framework. It serves as a placeholder that satisfies the coupler interface without modifying the solution.</p><p><strong>Arguments</strong></p><p>None.</p><p><strong>Returns</strong></p><p>An instance of <code>NothingCoupler</code>, indicating that no coupling is applied during the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L21-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.PrescribedBodyCoupler"><a class="docstring-binding" href="#FastIBPM.PrescribedBodyCoupler"><code>FastIBPM.PrescribedBodyCoupler</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PrescribedBodyCoupler{M}</code></pre><p>A subtype of <code>AbstractCoupler</code> for prescribed body motion or constraints.</p><p>This coupler stores a field <code>Binv</code>, representing a precomputed operator used to enforce prescribed motion (and forces) on the body. The type <code>M</code> is parametric, allowing flexibility in the data structure used for <code>Binv</code> (e.g., arrays or linear operators).</p><p><strong>Arguments</strong></p><ul><li><code>Binv::M</code> : Precomputed operator or matrix used to apply constraints for the prescribed body.</li></ul><p><strong>Returns</strong></p><p>An instance of <code>PrescribedBodyCoupler</code> suitable for simulations where body motion or behavior is explicitly prescribed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L37-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.FsiCoupler"><a class="docstring-binding" href="#FastIBPM.FsiCoupler"><code>FastIBPM.FsiCoupler</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">FsiCoupler{T,O&lt;:GeometricNonlinearBodyOperators,B}</code></pre><p>A subtype of <code>AbstractCoupler</code> for fluid–structure interaction (FSI) problems  with nonlinear structural dynamics.</p><p>This type encapsulates the structural state, geometric nonlinear operators, solver  tolerance, BiCGStab solver arguments, and iteration limits required for solving  coupled FSI problems using the CNAB time integration framework. </p><p>The keyword constructor allows easy setup of the coupler, including automatic  initialization of the structural state and operators for a given <code>GeometricNonlinearBody</code>.</p><p><strong>Fields</strong></p><ul><li><code>state::StructuralState{T}</code>          : Current state of the structural body (displacements, velocities, deformations), parameterized by numeric type <code>T</code>.</li><li><code>ops::O</code>                             : Operator object representing the geometric nonlinear structural model.</li><li><code>tol::T</code>                             : Numerical tolerance for the iterative solve.</li><li><code>bicgstabl_args::B</code>                  : Arguments for the BiCGStab(ℓ) iterative solver (tuple or named container).</li><li><code>maxiter::Int</code>                       : Maximum iterations during the solver phase.</li></ul><p><strong>Arguments (via keyword constructor)</strong></p><ul><li><code>backend::CPU</code>                       : Computation backend (CPU-based).</li><li><code>body::GeometricNonlinearBody{N,T}</code>  : Nonlinear structural body with <code>N</code> spatial dimensions and numeric type <code>T</code>.</li><li><code>tol</code>                                : Solver tolerance (default <code>1e-5</code>).</li><li><code>bicgstabl_args</code>                     : Solver arguments (default <code>(; abstol=T(1e-5), reltol=T(0.0))</code>).</li><li><code>maxiter::Int</code>                       : Maximum iterations (default <code>100</code>).</li></ul><p><strong>Returns</strong></p><p>A fully initialized <code>FsiCoupler</code> instance ready to couple the fluid and structural solvers in FSI simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L55-L84">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.CNAB"><a class="docstring-binding" href="#FastIBPM.CNAB"><code>FastIBPM.CNAB</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CNAB{N,T,B,U,P,R&lt;:Reg,C&lt;:AbstractCoupler,Au,Aω,Vb,BP&lt;:BodyPoints,A&lt;:ArrayPool,W}</code></pre><p>Central mutable type representing the state and configuration of a Crank–Nicolson  Adams–Bashforth (CNAB) time integration scheme for coupled fluid–structure simulations.</p><p>This struct holds all data required for time-stepping the simulation, including  fluid and body fields, transform plans, regularization operators, memory pools,  and solver buffers. It is designed for high-performance computing with support  for GPU/CPU backends and flexible handling of complex bodies and couplers.</p><p><strong>Fields</strong></p><ul><li><code>prob::IBProblem{N,T,B,U}</code>             : The immersed boundary problem defining the grid and bodies.</li><li><code>t0::T</code>                                : Initial simulation time.</li><li><code>i::Int</code>                               : Current time step index.</li><li><code>t::T</code>                                 : Current simulation time.</li><li><code>dt::T</code>                                : Time step size.</li><li><code>β::Vector{T}</code>                         : CNAB scheme coefficients.</li><li><code>plan::P</code>                              : FFT or spectral transform plan.</li><li><code>reg::R</code>                               : Regularizer or interpolation operator.</li><li><code>coupler::C</code>                           : Coupling strategy (<code>FsiCoupler</code>, <code>PrescribedBodyCoupler</code>, <code>NothingCoupler</code>).</li><li><code>redist_weights::Au</code>                   : Redistribution weights for fluid variables.</li><li><code>ω::Vector{Aω}</code>                        : Vorticity field(s).</li><li><code>ψ::Vector{Aω}</code>                        : Streamfunction or auxiliary field(s).</li><li><code>u::Vector{Au}</code>                        : Velocity field(s).</li><li><code>f_tilde::Vb</code>, <code>f::Vb</code>                 : Body force arrays.</li><li><code>points::BP</code>                           : Body point data structure.</li><li><code>nonlin::Vector{Vector{Aω}}</code>           : Buffers for nonlinear term history.</li><li><code>nonlin_count::Int</code>                    : Counter for nonlinear buffers.</li><li><code>ω_bndry::W</code>                           : Boundary vorticity data.</li><li><code>body_pool::A, fluid_pool::A, bndry_pool::A, structure_pool::A</code> : Memory pools to reduce allocations.</li></ul><p><strong>Arguments (via constructor)</strong></p><ul><li><code>prob::IBProblem{N,T}</code>                 : Immersed boundary problem containing grid and body setup.</li><li><code>dt</code>                                   : Time step size.</li><li><code>t0</code>                                   : Initial simulation time (default <code>0</code>).</li><li><code>n_step</code>                               : Number of previous time steps to retain for CNAB (default <code>2</code>).</li><li><code>delta</code>                                : Regularization kernel (default <code>DeltaYang3S()</code>).</li><li><code>backend</code>                              : Computation backend (<code>CPU()</code> or GPU device).</li><li><code>coupler_args</code>                         : Keyword arguments for the coupling constructor (e.g., <code>FsiCoupler</code>).</li></ul><p><strong>Description</strong></p><p>The constructor automatically allocates all buffers, precomputes FFT plans,  regularization operators, and memory pools, and bundles them into a CNAB object  ready for time integration. It performs the following main steps:</p><ol><li><strong>Setup grid and body</strong>: retrieves <code>grid</code> and <code>body</code> from <code>prob</code>.  </li><li><strong>Pre-allocate main fluid field</strong>: creates vorticity arrays.  </li><li><strong>Create FFT plan</strong>: precomputes spectral transforms for efficient solves.  </li><li><strong>Determine problem sizes</strong>: computes number of body points and structure variables.  </li><li><strong>Allocate memory pools</strong>: sizes pools for fluid, body, boundary, and structure arrays.  </li><li><strong>Bundle arguments</strong>: stores all fields and buffers in a named tuple.  </li><li><strong>Build the solution object</strong>: calls <code>initial_sol</code> to wrap arguments into a fully initialized CNAB instance.</li></ol><p><strong>Returns</strong></p><p>A <code>CNAB</code> object fully initialized for coupled time-stepping with the CNAB scheme.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L112-L168">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.CNAB_Binv_Precomputed"><a class="docstring-binding" href="#FastIBPM.CNAB_Binv_Precomputed"><code>FastIBPM.CNAB_Binv_Precomputed</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>CNAB<em>Binv</em>Precomputed(B)</p><p>A precomputed coupling operator for the CNAB solver.</p><p>Holds a precomputed matrix <code>B</code> used to solve the body–fluid coupling system  directly. Efficient when <code>B</code> is constant (e.g., for rigid or prescribed-motion bodies).</p><p>The object is callable like a function to compute the body force <code>f</code> given the  desired body velocity <code>u_ib</code> and the CNAB solver <code>sol</code>.</p><p>Arguments:</p><ul><li><code>B</code>: Precomputed coupling matrix.</li><li><code>f</code>: Body force vector (updated in-place).</li><li><code>u_ib</code>: Coupling right-hand side (desired body velocity minus interpolated fluid velocity).</li><li><code>sol::CNAB</code>: CNAB solver object (included for signature consistency, not used here).</li></ul><p>Returns:</p><ul><li>Updates <code>f</code> in-place.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L645-L664">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.initial_sol"><a class="docstring-binding" href="#FastIBPM.initial_sol"><code>FastIBPM.initial_sol</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">initial_sol(backend, body, sol_args, coupler_args)</code></pre><p>Initialize a CNAB simulation object based on the type of body in the problem.</p><p>This function has two methods depending on whether <code>body</code> is a static or geometrically  nonlinear (deforming) body:</p><ol><li><p><strong>Static Body Initialization (<code>AbstractStaticBody</code>)</strong>  </p><ul><li>Constructs a temporary CNAB with a <code>NothingCoupler</code>.  </li><li>Initializes body point positions.  </li><li>Computes regularization weights.  </li><li>Computes the inverse of the body–fluid coupling matrix.  </li><li>Creates a <code>PrescribedBodyCoupler</code> with the precomputed operator.  </li><li>Builds the final CNAB object with the coupler.  </li><li>Sets simulation time and initializes fluid fields.</li></ul></li><li><p><strong>Geometric Nonlinear Body Initialization (<code>GeometricNonlinearBody</code>)</strong>  </p><ul><li>Constructs an <code>FsiCoupler</code> for nonlinear structural dynamics.  </li><li>Builds the CNAB object with this coupler.  </li><li>Sets simulation time and zeros the fluid fields.  </li><li>Splits prescribed and deforming points.  </li><li>Initializes prescribed body points.  </li><li>Updates the structural state and initializes structure operators.  </li><li>Computes regularization and redistribution weights.</li></ul></li></ol><p><strong>Arguments</strong></p><ul><li><code>backend</code>                 : Computation backend (<code>CPU()</code> or GPU device).  </li><li><code>body</code>                    : The body in the problem (<code>AbstractStaticBody</code> or <code>GeometricNonlinearBody</code>).  </li><li><code>sol_args</code>                : Named tuple with CNAB fields and buffers.  </li><li><code>coupler_args</code>            : Keyword arguments passed to the coupler constructor.</li></ul><p><strong>Returns</strong></p><p>A fully initialized <code>CNAB</code> object ready for time integration, configured according  to the type of body and the specified coupling strategy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L256-L291">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.zero_vorticity!"><a class="docstring-binding" href="#FastIBPM.zero_vorticity!"><code>FastIBPM.zero_vorticity!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">zero_vorticity!(sol::CNAB)</code></pre><p>Reset all fluid-related fields in a CNAB simulation object.</p><p>This function sets the vorticity (<code>ω</code>), streamfunction (<code>ψ</code>), and velocity (<code>u</code>)  fields to zero across all grid levels. It also resets the nonlinear history counter  and re-applies the initial prescribed flow field (<code>u0</code>).</p><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code> : The CNAB simulation object whose fluid fields are being reset.</li></ul><p><strong>Returns</strong></p><p>The updated <code>CNAB</code> object with zeroed fluid fields and initial flow re-applied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L330-L344">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.set_time!"><a class="docstring-binding" href="#FastIBPM.set_time!"><code>FastIBPM.set_time!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">set_time!(sol::CNAB, i::Integer)</code></pre><p>Advance the CNAB integrator to a specific time step.</p><p>This function updates the internal step index (<code>i</code>) and computes the corresponding  physical time (<code>t</code>) of the simulation using:</p><pre><code class="nohighlight hljs">t = t0 + dt * (i - 1)</code></pre><p>where <code>t0</code> is the initial simulation time and <code>dt</code> is the time step size. This ensures  that all time-dependent operations in the simulation remain consistent.</p><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code> : The CNAB simulation object to update.</li><li><code>i::Integer</code> : The target time step index.</li></ul><p><strong>Returns</strong></p><p>The updated <code>CNAB</code> object with the new time step and physical time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L369-L388">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.step!"><a class="docstring-binding" href="#FastIBPM.step!"><code>FastIBPM.step!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">step!(sol::CNAB)</code></pre><p>Advance the CNAB simulation by one time step.</p><p>This is the main time integration routine that updates both the fluid and structure  fields according to the CNAB scheme. A single call to <code>step!</code> performs the following sequence:</p><ol><li>Advance the simulation time step (<code>set_time!</code>).  </li><li>Predict the new fluid and body state (<code>prediction_step!</code>).  </li><li>Apply fluid–structure coupling (<code>coupling_step!</code>).  </li><li>Project the velocity field to enforce incompressibility (<code>projection_step!</code>).  </li><li>Update the vorticity field (<code>apply_vorticity!</code>).  </li></ol><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code> : The CNAB simulation object representing the current state.</li></ul><p><strong>Returns</strong></p><p>The updated <code>CNAB</code> object after one complete time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L397-L416">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.update_reg!"><a class="docstring-binding" href="#FastIBPM.update_reg!"><code>FastIBPM.update_reg!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">update_reg!(sol::CNAB, body, i)</code></pre><p>Update the regularization weights for the simulation based on the type of body.</p><p>There are two methods:</p><ol><li><p><strong>Static bodies (<code>AbstractStaticBody</code>)</strong>  </p><ul><li>No update is necessary because the body does not move or deform.  </li><li>The function returns <code>nothing</code>.</li></ul></li><li><p><strong>Prescribed-motion bodies (<code>AbstractPrescribedBody</code>)</strong>  </p><ul><li>Updates the regularization weights by calling <code>update_weights!</code> with the  current body point positions.  </li><li>Ensures that the mapping from body points to the grid reflects the current motion.</li></ul></li></ol><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code> : CNAB simulation object containing the grid and body fields.  </li><li><code>body</code>      : The body object (<code>AbstractStaticBody</code> or <code>AbstractPrescribedBody</code>).  </li><li><code>i</code>         : Index or set of points for which the regularization is updated (used for prescribed bodies).</li></ul><p><strong>Returns</strong></p><ul><li>Nothing for static bodies.  </li><li>Updates <code>sol.reg</code> in-place for prescribed-motion bodies.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L430-L454">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM._A_factor"><a class="docstring-binding" href="#FastIBPM._A_factor"><code>FastIBPM._A_factor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_A_factor(sol::CNAB)</code></pre><p>Compute the diffusion coefficient used in the CNAB time-stepping scheme.</p><p>This coefficient arises in the semi-implicit (Crank–Nicolson) treatment of the viscous term and is given by:</p><pre><code class="nohighlight hljs">A = Δt / (2 * Re)</code></pre><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code> : CNAB simulation object containing the current state and parameters.</li></ul><p><strong>Returns</strong></p><ul><li>Diffusion coefficient (same numeric type as <code>sol.dt</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L462-L477">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.Ainv"><a class="docstring-binding" href="#FastIBPM.Ainv"><code>FastIBPM.Ainv</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">Ainv(sol::CNAB, level)</code></pre><p>Construct the inverse viscous operator used in the CNAB time-stepping scheme.</p><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code>: CNAB simulation object containing the problem definition and FFT plans.</li><li><code>level</code>: Grid refinement level at which to build the operator.</li></ul><p><strong>Returns</strong></p><ul><li><code>EigenbasisTransform</code>: An operator that applies the inverse of <code>(I - aΔ)</code> in spectral space, typically used for implicit diffusion updates within the CNAB integrator.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L482-L495">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.prediction_step!"><a class="docstring-binding" href="#FastIBPM.prediction_step!"><code>FastIBPM.prediction_step!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">prediction_step!(sol::CNAB)
prediction_step!(sol::CNAB, level)
prediction_step!(sol::CNAB, level, u_work)</code></pre><p>Perform the CNAB prediction of the vorticity field.</p><p>This function advances the fluid state by computing the predicted vorticity using a semi-implicit Crank–Nicolson treatment for diffusion and an Adams–Bashforth treatment for nonlinear convection. It supports multigrid levels and avoids unnecessary allocations with array pools.</p><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code>: CNAB simulation object.</li><li><code>level</code> (optional): Grid level for single-level update.</li><li><code>u_work</code> (optional): Preallocated velocity array for in-place computation.</li></ul><p><strong>Returns</strong></p><ul><li>Updated vorticity field in-place within <code>sol</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L504-L523">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.coupling_step!"><a class="docstring-binding" href="#FastIBPM.coupling_step!"><code>FastIBPM.coupling_step!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">coupling_step!(sol::CNAB)</code></pre><p>Perform the fluid–structure coupling step for the current CNAB time step.</p><p>This function dispatches to the appropriate coupling routine based on the solver&#39;s <code>coupler</code>. For a prescribed body, it computes the fluid velocity at body points, evaluates the coupling residual, and solves for the correcting body force to enforce velocity constraints.</p><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code>: CNAB simulation object with the current fluid and body state.</li></ul><p><strong>Returns</strong></p><ul><li>Updates <code>sol.f_tilde</code> and body-related fields in-place.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L598-L613">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM._coupling_step!"><a class="docstring-binding" href="#FastIBPM._coupling_step!"><code>FastIBPM._coupling_step!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_coupling_step!(sol::CNAB, coupler::FsiCoupler)
_coupling_step!(sol::CNAB, coupler::FsiCoupler, fs, χs, ψ_b_work)</code></pre><p>Advance the fluid–structure interaction (FSI) system for deformable bodies.</p><p>This function couples the fluid and structure dynamics within the immersed boundary framework, ensuring that the motion of a deformable body and the surrounding fluid remain consistent.</p><p>The first method prepares temporary arrays and calls the main solver. The second performs the actual coupling iterations until convergence.</p><p><strong>Purpose</strong></p><p>Used in simulations where the body can deform under fluid forces. It enforces the mutual interaction between fluid and structure during each time step.</p><p><strong>Notes</strong></p><p>Works with deformable immersed bodies through an implicit iterative scheme.</p><p><strong>Returns</strong></p><p>Nothing. Updates the solver state in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L781-L803">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.B_inverse_rigid"><a class="docstring-binding" href="#FastIBPM.B_inverse_rigid"><code>FastIBPM.B_inverse_rigid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">B_inverse_rigid(sol::CNAB{N,T,&lt;:AbstractStaticBody})</code></pre><p>Construct a precomputed coupling operator for a rigid (static) body.</p><p>This function builds the body–fluid coupling matrix <code>B</code> and precomputes its inverse via Cholesky factorization. The returned object is a  <code>CNAB_Binv_Precomputed</code>, which can be applied during the CNAB  coupling step as <code>coupler.Binv(sol.f_tilde, rhs, sol)</code>.</p><ul><li>Only for static/non-deforming bodies.</li><li>Precomputing <code>B</code> ensures fast solves at each timestep.</li><li>The matrix is assumed symmetric positive definite (SPD).</li></ul><p><strong>Inputs</strong></p><ul><li><code>sol::CNAB</code>: CNAB simulation object containing the body and grid.</li></ul><p><strong>Returns</strong></p><ul><li><code>CNAB_Binv_Precomputed</code>: Callable object that efficiently applies <code>B⁻¹</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L677-L697">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.B_rigid_mul!"><a class="docstring-binding" href="#FastIBPM.B_rigid_mul!"><code>FastIBPM.B_rigid_mul!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">B_rigid_mul!(u_ib, f, sol::CNAB{N,T})</code></pre><p>Apply the rigid-body coupling operator to a force vector.</p><p>This function defines the action of the rigid-body coupling matrix <code>B</code> such that <code>u_ib = B * f</code>, where <code>f</code> is a body force distribution and <code>u_ib</code> is the resulting velocity at the immersed boundary points.</p><p>Two methods are provided:</p><ol><li>A wrapper that reinterprets flat arrays as vectors of <code>SVector{N,T}</code> and calls the core implementation.</li><li>The main routine, which:<ul><li>Regularizes the body forces to the fluid grid.</li><li>Solves for the induced velocity field via the vorticity–streamfunction formulation.</li><li>Interpolates the resulting fluid velocity back to the body points.</li></ul></li></ol><p>This operation is used when assembling the coupling matrix in <code>B_inverse_rigid</code> and represents how the fluid mediates the response of the rigid body to applied forces.</p><p><strong>Inputs</strong></p><ul><li><code>u_ib</code>: Output array for body velocities.</li><li><code>f</code>: Body force vector.</li><li><code>sol::CNAB</code>: CNAB solver containing grid, operators, and regularization data.</li></ul><p><strong>Returns</strong></p><ul><li><code>u_ib</code>: The updated body velocity vector after applying the operator.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L728-L755">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.B_deform_mul!"><a class="docstring-binding" href="#FastIBPM.B_deform_mul!"><code>FastIBPM.B_deform_mul!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">B_deform_mul!(u_ib, f, sol::CNAB)</code></pre><p>Apply the fluid–structure coupling operator <code>B</code> for a deformable body.</p><p>This function maps body forces <code>f</code> to immersed-boundary velocities <code>u_ib</code>, accounting for force spreading, structural response, and velocity interpolation back to the Lagrangian points.</p><p>Three methods are provided:</p><ol><li>A converter that reinterprets flat scalar vectors as structured SVector arrays.</li><li>A wrapper that allocates workspace arrays.</li><li>The core routine that computes the coupled fluid–structure response.</li></ol><p><strong>Arguments</strong></p><ul><li><code>u_ib</code> : Output array for body velocities (updated in-place).</li><li><code>f</code>    : Input body force vector.</li><li><code>sol::CNAB</code> : CNAB solver object containing grid, operators, and regularization.</li></ul><p><strong>Returns</strong></p><ul><li><code>u_ib</code> updated in-place with the velocity induced by <code>f</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L921-L942">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.f_to_f_tilde!"><a class="docstring-binding" href="#FastIBPM.f_to_f_tilde!"><code>FastIBPM.f_to_f_tilde!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">f_to_f_tilde!(f, sol::CNAB; inverse=false)</code></pre><p>Convert between the physical body force <code>f</code> and its regularized (spread) form <code>f_tilde</code> used in the fluid solver.</p><p>This function rescales the immersed boundary force depending on the direction of conversion:</p><ul><li>When <code>inverse=false</code> (default), it converts <code>f_tilde → f</code>, applying the proper scaling for the boundary point spacing and coupling factor.</li><li>When <code>inverse=true</code>, it converts <code>f → f_tilde</code>, restoring the fluid solver’s representation of the force.</li></ul><p>This transformation ensures consistent units and coupling strength between the structure and the fluid solvers.</p><p><strong>Notes</strong></p><p>The conversion uses:</p><ul><li><code>dt</code> : Time step size.</li><li><code>ds</code> : Arc length of immersed boundary points.</li><li><code>h</code>  : Grid spacing.</li><li><code>k = _f_tilde_factor(sol)</code> : Coupling-dependent scaling factor.</li></ul><p><strong>Arguments</strong></p><ul><li><code>f</code> : Force vector, modified in-place.</li><li><code>sol::CNAB</code> : CNAB solver object containing time step, grid, and coupling parameters.</li><li><code>inverse</code> : Whether to apply the inverse scaling (<code>f → f_tilde</code>).</li></ul><p><strong>Returns</strong></p><p>This function returns <code>nothing</code>; the input <code>f</code> is modified in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L982-L1012">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.redist!"><a class="docstring-binding" href="#FastIBPM.redist!"><code>FastIBPM.redist!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">redist!(f, sol::CNAB)</code></pre><p>Redistribute forces on the immersed boundary to ensure consistency with the fluid.</p><p>This function corrects the body forces <code>f</code> after numerical operations by:</p><ul><li>Spreading the force to the fluid grid.</li><li>Applying precomputed redistribution weights.</li><li>Interpolating the corrected forces back to the body points.</li></ul><p><strong>Arguments</strong></p><ul><li><code>f</code>: The body force vector (modified in-place).</li><li><code>sol::CNAB</code>: The CNAB solver state containing fluid and body information.</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: The input <code>f</code> is updated in-place.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1028-L1044">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.update_redist_weights!"><a class="docstring-binding" href="#FastIBPM.update_redist_weights!"><code>FastIBPM.update_redist_weights!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">update_redist_weights!(sol::CNAB; tol=1e-10)</code></pre><p>Compute the redistribution weights used in <code>redist!</code> to ensure consistent transfer of forces between the immersed boundary and the fluid grid.</p><p>The weights correct for imbalances caused by spreading forces from body points to the grid, so that later redistribution preserves the physical accuracy of the simulation.</p><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code>: The CNAB solver object containing the body and fluid state.</li><li><code>tol</code>: Minimum threshold for weight inversion to avoid division by zero (default <code>1e-10</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: The redistribution weights are stored in <code>sol.redist_weights</code> and updated in-place.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1059-L1075">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.projection_step!"><a class="docstring-binding" href="#FastIBPM.projection_step!"><code>FastIBPM.projection_step!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">projection_step!(sol::CNAB)</code></pre><p>Project the fluid vorticity field to remove the effect of the applied body forces (<code>f_tilde</code>), ensuring that the flow field satisfies the updated constraints after force spreading and redistribution.</p><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code>: The CNAB solver object containing the fluid and body state.</li></ul><p><strong>Effects</strong></p><ul><li>Modifies <code>sol.ω</code> in-place to account for the applied body forces.</li><li>Swaps <code>sol.ω</code> and <code>sol.ψ</code> internally to reuse memory.</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: The projection modifies the solver state in-place.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1094-L1109">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.apply_vorticity!"><a class="docstring-binding" href="#FastIBPM.apply_vorticity!"><code>FastIBPM.apply_vorticity!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">apply_vorticity!(sol::CNAB)</code></pre><p>Compute the fluid velocity field from the current vorticity (<code>ω</code>) and update the solution  to satisfy boundary conditions and base flow.</p><p><strong>Arguments</strong></p><ul><li><code>sol::CNAB</code>: The CNAB solver object containing the fluid and body state.</li></ul><p><strong>Effects</strong></p><ul><li>Updates <code>sol.u</code> (velocity field) and ensures <code>sol.ω</code> satisfies boundary conditions.</li><li>Handles all multigrid levels, applying necessary interpolations between levels.</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: Modifies the solver state in-place.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1136-L1151">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.ab_coeffs"><a class="docstring-binding" href="#FastIBPM.ab_coeffs"><code>FastIBPM.ab_coeffs</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ab_coeffs(T, n)</code></pre><p>Return the Adams-Bashforth coefficients for a given order <code>n</code>.</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: Container type to hold the coefficients (e.g., Tuple or Vector).</li><li><code>n</code>: Order of the Adams-Bashforth scheme (currently only 1 or 2).</li></ul><p><strong>Returns</strong></p><ul><li>A container of type <code>T</code> with the AB coefficients:<ul><li><code>n = 1</code>: <code>[1]</code> (forward Euler, AB1)</li><li><code>n = 2</code>: <code>[-1//2, 3//2]</code> (AB2)</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>AB1 is first-order explicit Euler.</li><li>AB2 is second-order, using current and previous derivative values for better accuracy.</li><li>Only <code>n=1</code> and <code>n=2</code> are supported; other values throw a <code>DomainError</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">ab_coeffs(Tuple, 1)  # returns (1,)
ab_coeffs(Tuple, 2)  # returns (-1//2, 3//2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1179-L1203">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM._f_tilde_factor"><a class="docstring-binding" href="#FastIBPM._f_tilde_factor"><code>FastIBPM._f_tilde_factor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_f_tilde_factor(sol)</code></pre><p>Compute the scaling factor used to convert between the physical body force <code>f</code>  and the regularized force <code>f_tilde</code> used in the fluid solver.</p><p><strong>Arguments</strong></p><ul><li><code>sol</code>: CNAB solver object containing grid and time step information.</li></ul><p><strong>Returns</strong></p><ul><li>A scalar factor <code>k = - h^N / Δt</code> where:<ul><li><code>h</code> is the uniform grid spacing</li><li><code>N</code> is the spatial dimension</li><li><code>Δt</code> is the time step size</li><li>The negative sign follows the solver convention for force transformation</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>This factor is used in <code>f_to_f_tilde!</code> to scale forces correctly between  the immersed boundary and the fluid grid.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1216-L1235">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.surface_force!"><a class="docstring-binding" href="#FastIBPM.surface_force!"><code>FastIBPM.surface_force!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">surface_force!(f, sol)</code></pre><p>Convert the redistributed force <code>f_tilde</code> back to the physical surface force <code>f</code>.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: Output array that will store the physical surface force.</li><li><code>sol</code>: CNAB solver object containing <code>f_tilde</code> and grid/time info.</li></ul><p><strong>Behavior</strong></p><ul><li>Computes a scaling factor <code>k = -h^N / Δt</code> using <code>_f_tilde_factor(sol)</code>.</li><li>Applies the formula <code>f .= -k * sol.f_tilde</code> to recover the actual force on the body surface.</li></ul><p><strong>Notes</strong></p><p>This reverses the scaling applied in <code>f_to_f_tilde!</code>.</p><p><strong>Returns</strong></p><ul><li><code>nothing</code>: The physical surface force is written in-place to <code>f</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1243-L1261">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.surface_force_sum"><a class="docstring-binding" href="#FastIBPM.surface_force_sum"><code>FastIBPM.surface_force_sum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">surface_force_sum(sol)</code></pre><p>Compute the total hydrodynamic force exerted by the fluid on the immersed body.</p><p><strong>Arguments</strong></p><ul><li><code>sol</code>: CNAB solver object containing <code>f_tilde</code> and grid/time info.</li></ul><p><strong>Behavior</strong></p><ul><li>Computes the scaling factor <code>k = -h^N / Δt</code> using <code>_f_tilde_factor(sol)</code>.</li><li>Sums all entries of <code>sol.f_tilde</code> (the redistributed force at Lagrangian points).</li><li>Scales and flips the sign to recover the physical total force: <code>total_force = -k * sum(sol.f_tilde)</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>total_force</code>: The net physical force vector acting on the body.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1269-L1285">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.CNAB_signature"><a class="docstring-binding" href="#FastIBPM.CNAB_signature"><code>FastIBPM.CNAB_signature</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">const CNAB_signature</code></pre><p>A compile-time constant used as a unique identifier for the <code>CNAB</code> structure. It stores the string <code>FastIBPM.jl:CNAB</code> as a vector of bytes (<code>Vector{UInt8}</code>).</p><p>This signature can be used, for example, in type-checking, serialization, or validation routines.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1293-L1300">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.save"><a class="docstring-binding" href="#FastIBPM.save"><code>FastIBPM.save</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">save(io::IO, sol::CNAB)</code></pre><p>Serialize the current state of a <code>CNAB</code> simulation and write it to the given I/O stream (e.g., a file). This allows the simulation to be saved and later restored.</p><p><strong>Arguments</strong></p><ul><li><code>io</code>: An I/O stream to write the binary data to (e.g., a file handle).</li><li><code>sol</code>: The <code>CNAB</code> solver object containing the current simulation state.</li></ul><p><strong>Output</strong></p><ul><li>Nothing; writes directly to the provided I/O stream.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1305-L1317">source</a></section><section><div><pre><code class="language-julia hljs">save(filename::AbstractString, x)</code></pre><p>Save the state of object <code>x</code> to a file on disk.</p><p>This function opens the file specified by <code>filename</code> for writing and delegates the actual saving to a user-defined <code>save</code> method for the object <code>x</code>. It serves as a wrapper to manage file I/O while preserving multiple dispatch.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code> : Path to the file to write to.</li><li><code>x</code>                       : Object whose state will be saved.</li></ul><p><strong>Returns</strong></p><ul><li>Nothing. The function writes the object&#39;s state to disk.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/FastIBPM.jl#L115-L128">source</a></section></details></article><article><details class="docstring" open="true"><summary id="FastIBPM.load!"><a class="docstring-binding" href="#FastIBPM.load!"><code>FastIBPM.load!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">load!(io::IO, sol::CNAB)</code></pre><p>Restore a previously saved <code>CNAB</code> simulation state from an I/O stream (e.g., a binary file) into an existing solver object. This reconstructs the simulation exactly as it was when saved.</p><p><strong>Arguments</strong></p><ul><li><code>io</code>: An I/O stream to read the binary data from (e.g., a file handle).</li><li><code>sol</code>: The <code>CNAB</code> solver object to populate with the loaded state.</li></ul><p><strong>Output</strong></p><ul><li>Nothing; the <code>sol</code> object is updated in-place with the loaded simulation state.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/cnab.jl#L1361-L1373">source</a></section><section><div><pre><code class="language-julia hljs">load!(filename::AbstractString, x)</code></pre><p>Load the state of object <code>x</code> from a file on disk.</p><p>This function opens the file specified by <code>filename</code> and delegates the actual loading to a user-defined <code>load!</code> method for the object <code>x</code>. It acts as a convenient wrapper to handle file I/O while preserving Julia&#39;s multiple dispatch semantics.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code> : Path to the file to load from.</li><li><code>x</code>                       : Object to populate with the loaded data.</li></ul><p><strong>Returns</strong></p><ul><li>The updated object <code>x</code> with its state loaded from the file.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NUFgroup/FastIBPM.jl/blob/be8f5d4f69cb56dfdc3566168640f5c7ce72da13/src/FastIBPM.jl#L95-L108">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../problem_definition/">« Problem Definition</a><a class="docs-footer-nextpage" href="../prescribed_bodies/">Prescribed Bodies »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 1 December 2025 22:51">Monday 1 December 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
